
    // Try to load existing keys from Windows Credential Manager
    if let Ok(Some(stored_key)) = keystore::load_keypair() {
        match cryptochat_crypto_core::pgp::PgpKeyPair::from_secret_key(&stored_key.secret_key_armored) {
            Ok(keypair) => {
                // Verify fingerprint matches
                if keypair.fingerprint() == stored_key.fingerprint {
                    app_state.set_keypair(keypair);
                    println!("✓ Loaded existing keys from secure storage");
                    println!("  Fingerprint: {}", stored_key.fingerprint);
                } else {
                    eprintln!("⚠ WARNING: Stored key fingerprint mismatch - keys NOT loaded for security");
                }
            }
            Err(e) => {
                eprintln!("⚠ Failed to parse stored key: {} - will generate new keys", e);
            }
        }
    }
